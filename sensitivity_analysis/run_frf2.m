clc
close all
clear variables

dgn_mx = table2array(readtable(fullfile(pwd, 'sensitivity_analysis', 'kcurrent_dgn_matrix.csv')));

% protocol

% lower and upper bound
[num_runs, num_vars] = size(dgn_mx);
p0 = [33, 15.5, 20, 8, 7, 0.3956, 0.00095, 0.051335, 0.14067, 0.387, ...
    22.5, 45.2, 40, 5.7, 2.058, 803, 0.05766, 0.07496, ...
    5334, 0.05766, ...
    1050, 0 ...
    13.17, 0.0428, ...
    59.215, 5.476, 594.31, 4.753];
lb = [-50, -50, -50, eps, eps, eps, eps, eps, eps, eps, ...
    -70, -70, -70, eps, eps, eps, eps, eps, ...
    5000, eps, ...
    300, eps, ...
    eps, eps, ...
    eps, eps, 300, eps
];
ub = [70, 50, 50, 50, 30, 10, 0.005, 0.5, 1, 1, ...
    50, 50, 50, 50, 100, 1000, 0.5, 0.5, ...
    10000, 0.5, ...
    2500, 0.5, ...
    100, 0.5, ...
    100, 10, 900, 10
];

res = zeros(num_runs, 1);
for i = 1:num_runs
    fprintf("Degisn [%i/%i] \n", i, num_runs)
    
    % set up parameters according to given design
    dgn = dgn_mx(i, :);
    p = zeros(num_vars, 1);
    for j = 1:num_vars
        if dgn(j) == 1
            p(j) = ub(j);
        else
            p(j) = lb(j);
        end
    end


end
