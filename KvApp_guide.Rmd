---
title: "User Guide for KvApp"
author: "Haedong Kim"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Getting Started

There are four associated files as shown in Figure 1 below: `KvAppBeta`, `MyAppInstaller_mcr`, `MyAppInstaller_web`, and `splash`.

![Consisting files of the applications.](KvApp_guide_img/folder_struct.png){width=50%}

`KvAppBeta` is the file that runs the application, but you will get the error message in Figure 2 if the correct version of MATLAB is not installed on the machine.

![Error message when the right version of MATLAB is not installed on the target machine.](KvApp_guide_img/runtime_error.png){width=50%}

`MyAppInstaller_web` will install the packaged application and MATLAB Runtime from the Internet, which enables the application to run without having MATLAB installed. Your computer needs to be connected to the Internet to complete the installation. If the Internet connection is not available, `MyAppInstaller_mcr` will install the necessary programs locally. A few screenshots below in Figure 3 show the installation process. The other file `splash` is just an image file for the application icon.

![Screenshots of the installation process.](KvApp_guide_img/install.png)

## Modules and Functions

KvApp consists of three modules, as shown in Figure 4: Experimental Protocol & Data, Computer Model, and Model Outputs & Kinetics Modeling Results. 

![Startup window of KvApp.](KvApp_guide_img/window.png){width=50%}

The data to be investigated *in silico* should be stored in an Excel file, with the first column corresponding to time and the other columns normalized currents for voltage steps in increasing order. This is a default format when I~Ksum~ traces are transferred to a tabular format in ClampFit. Figure 5 is an example of I~Ksum~ recordings. To import a dataset, we need to specify the experimental protocol of the voltage-clamp method used to generate that dataset. If the defined protocol does not match the data, it will give an error or does not display the data correctly.

![Example of raw I~Ksum~ data in ClampFit.](KvApp_guide_img/pClamp.png)

The Computer Model module shows equations and kinetics parameters of computers models of K~v~ isoforms separated by tabs. The Computer Model module shows equations and kinetics parameters of computers models of potassium isoforms, separated and grouped by tabs. The Kv4.2 model in the first tab is the only stand-alone model in which every kinetic variables and parameter are independent of other models. The second tab contains three closely connected models. Each model can be chosen to be or not be included in calculating the total potassium current by checking or unchecking the Include boxes. The kinetic parameters can be adjusted manually by entering the number in the corresponding box and pressing the enter/return key. Parameters in red are identified as having significant impacts on the model behavior.

These parameters in red can be calibrated automatically using the Turn Calibration button in the Model Output tab of the third module. This function calibrates the models by minimizing discrepancies between model prediction and experimental I~Ksum~ traces. The fitness of calibration results is visualized, and the drop-down button allows to select different voltage steps. The calibrated parameter values can be saved using the Model Parameters Save button in an Excel file. It is desirable to perform model calibration separately, utilizing more computing power and time for better results. Other tabs named after the K~v~ isoforms show kinetic variables such as steady states, time constants, and transition rates as shown on Figure 6.

![Kinetics modeling results.](KvApp_guide_img/kvoutput.png)

## Examples

### Example 1: 4.5-sec Data

example with 9 voltage steps rather than the full data.

### Example 2: 25-sec Data

example with 25-sec data
